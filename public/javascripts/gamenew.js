function killPiece(a,b,c,d){var e=d.map,f=e[c],g=e[b],h=d.getTile(b);deactivate("highlight"),deactivate("highlight-enemy"),$(this).fadeOut(500,function(){$(this).css("visibility","hidden"),$(this).fadeIn("fast",function(){a.removeChild(a.firstChild),$(a).append(this),$(h).html("<piece></piece>"),$(this).css("visibility","visible")})}),e[c]=e[b],e[b]=void 0,e[g]=c,e[f]=void 0}function swapPiece(a,b,c,d){var e=d.map,f=e[b],g=d.getTile(b);deactivate("highlight"),deactivate("highlight-enemy"),$(this).fadeOut(500,function(){$(this).css("visibility","hidden"),$(a).empty(),$(a).append(this),$(g).html("<piece></piece>"),$(this).fadeIn("fast",function(){$(this).css("visibility","visible")})}),e[c]=e[b],e[b]=void 0,e[f]=c}function findLocation(a,b){var c=getClassNames(a);return b[mapKey(c)]}function getClassNames(a){var b=a.getAttribute("class");return b?b.split(" "):void 0}function mapKey(a){return a[0]+" "+a[1]+" "+a[2]}function deactivate(a){for(var b=$("."+a),c=b.length,d=0;d<c;d++)$(b[d]).unbind("click"),$(b[d]).toggleClass(a)}function pawnRules(a){for(var b=$(".pawn."+a.color),c=b.length,d=0;d<c;d++)$(b[d]).bind("click",newPawnRule.bind(b[d],a))}function rookRules(a){for(var b=$(".rook."+a.color),c=b.length,d=0;d<c;d++)$(b[d]).bind("click",newRookRule.bind(b[d],a))}function bishopRules(a){for(var b=$(".bishop."+a.color),c=b.length,d=0;d<c;d++)$(b[d]).bind("click",newBishopRule.bind(b[d],a))}function knightRules(a){for(var b=$(".knight."+a.color),c=b.length,d=0;d<c;d++)$(b[d]).bind("click",newKnightRule.bind(b[d],a))}function kingRules(a){var b=$(".king."+a.color)[0];$(b).bind("click",kingMoves.bind(b,a))}function queenRules(a){var b=$(".queen."+a.color)[0];$(b).bind("click",queenMoves.bind(b,a))}function killPiece(a,b,c,d){var e=d.map,f=e[c],g=e[b],h=d.getTile(b);deactivate("highlight"),deactivate("highlight-enemy"),$(this).fadeOut(500,function(){$(this).css("visibility","hidden"),$(this).fadeIn("fast",function(){a.removeChild(a.firstChild),$(a).append(this),$(h).html("<piece></piece>"),$(this).css("visibility","visible")})}),e[c]=e[b],e[b]=void 0,e[g]=c,e[f]=void 0}function swapPiece(a,b,c,d){var e=d.map,f=e[b],g=d.getTile(b);deactivate("highlight"),deactivate("highlight-enemy"),$(this).fadeOut(500,function(){$(this).css("visibility","hidden"),$(a).empty(),$(a).append(this),$(g).html("<piece></piece>"),$(this).fadeIn("fast",function(){$(this).css("visibility","visible")})}),e[c]=e[b],e[b]=void 0,e[f]=c}function findLocation(a,b){var c=getClassNames(a);return b[mapKey(c)]}function getClassNames(a){var b=a.getAttribute("class");return b?b.split(" "):void 0}function mapKey(a){return a[0]+" "+a[1]+" "+a[2]}function deactivate(a){for(var b=$("."+a),c=b.length,d=0;d<c;d++)$(b[d]).unbind("click"),$(b[d]).toggleClass(a)}function pawnRules(a){for(var b=$(".pawn."+a.color),c=b.length,d=0;d<c;d++)$(b[d]).bind("click",a.moves.newPawnRule(b[d]))}function rookRules(a){for(var b=$(".rook."+a.color),c=b.length,d=0;d<c;d++)$(b[d]).bind("click",a.moves.newRookRule(b[d]))}function bishopRules(a){for(var b=$(".bishop."+a.color),c=b.length,d=0;d<c;d++)$(b[d]).bind("click",a.moves.newBishopRule(b[d]))}function knightRules(a){for(var b=$(".knight."+a.color),c=b.length,d=0;d<c;d++)$(b[d]).bind("click",a.moves.newKnightRule(b[d]))}function kingRules(a){var b=$(".king."+a.color)[0];$(b).bind("click",a.moves.kingMoves(b))}function queenRules(a){var b=$(".queen."+a.color)[0];$(b).bind("click",a.moves.queenMoves(b))}var Game=function(a,b,c,d){this.socket=new Signals(this,c),this.time=new Timer(this,b,d),this.moves=new Moves(this),this.color=a,this.opponent,this.map=[],this.id,this.overlay=function(a){var b=jQuery('<div id="overlay">'+a+"</div>");b.appendTo($("#board")),$("#board").bind("click",function(){$("#overlay").remove(),$(this).unbind("click")})},this.setId=function(a){this.id=a},this.getTile=function(a){return $("td")[a]},this.getPiece=function(a){return $("piece")[a]}};Game.prototype.isActive=function(){return"Not Started"!==$("state").text()},Game.prototype.convertMap=function(){return"black"===this.color?this.map.slice(0,64):this.map.slice(0,64).reverse()},Game.prototype.unlock=function(){this.setRules()},Game.prototype.lockout=function(){deactivate("highlight"),deactivate("highlight-enemy"),$("piece").unbind()},Game.prototype.createMap=function(){for(var a,b=$("piece"),c=b.length,d=0;d<c;d++)a=getClassNames(b[d]),a&&(a=mapKey(a)),this.map[a]=d,this.map[d]=a},Game.prototype.setupGame=function(a){$("#gameStatsBox").toggle(),$("#gameStats").bind("click",function(){$("#gameStatsBox").toggle()}),$("#quit").bind("click",this.quit.bind(this));var b=this.color;"black"===b?this.opponent="white":this.opponent="black",this.isActive()&&(this.socket.send("join",{id:this.id,time:this.time.time}),a===b&&(this.time.startTimer(),this.overlay("Your Turn"),this.setRules()))},Game.prototype.setRules=function(){pawnRules(this),rookRules(this),knightRules(this),bishopRules(this),kingRules(this),queenRules(this)},Game.prototype.quit=function(){this.socket.send("quit",{id:this.id}),window.location.href="/"},Game.prototype.winner=function(){this.time.clear(),this.lockout(),this.overlay("You Won"),this.socket.send("winner",this.id)},Game.prototype.loser=function(){$("#overlay").remove(),this.time.clear(),this.overlay("You Lost"),this.lockout()},Game.prototype.swapTurn=function(a){this.time.startTimer(),this.overlay(a),this.unlock(),$("turn").html(this.color)},Game.prototype.endTurn=function(){this.time.endTimer(),this.socket.send("save",{turn:this.opponent,board:this.map.slice(0,64),id:this.id}),this.lockout()},Game.prototype.updateMoved=function(a){var b=63-a.pos,c=63-a.mv,d=this.getTile(c);swapPiece(d,b,c)},Game.prototype.updateKilled=function(a){var b=63-a.pos,c=63-a.mv,d=this.getTile(c);killPiece(d,b,c)},Game.prototype.updatePiece=function(a){var b,c=a.piece,d=63-a.mv,e=this.map[d];this.map[c]=d,this.map[d]=a.piece,this.map[e]=void 0,b=this.getTile(d),$(b).empty(),$(b).append(jQuery(a.pieceCode))},Game.prototype.displayDead=function(a,b){var c=(this.getPiece(a),this.findDead()),d=c.length,e=this;this.map;if(d){for(var f='<div id="dead"><table><tr>',g=0;g<d;g++)f+="<td>"+c[g]+"</td>";var h=jQuery(f+"</tr></table></div>");h.appendTo($("#board")),$("#dead").find("piece").bind("click",function(){var a=e.getTile(b),c=mapKey(getClassNames(this)),d=e.map[b];e.map[d]=void 0,e.map[b]=c,e.map[c]=b,$(a).empty(),$(a).append(this),$("#dead").remove(),e.revive(c,$(a).html(),b),this.socket.send("revive",{id:this.id,piece:c,pieceCode:$(a).html(),mv:b,time:this.time.time,turn:this.opponent}),this.endTurn()})}else this.endTurn()},Game.prototype.findDead=function(){var a,b=this.map,c=this.color,d=[];return a="rook "+c+" pos-",b[a+"l"]||d.push('<piece class="'+a+'l glyphicon glyphicon-tower"></piece>'),b[a+"r"]||d.push('<piece class="'+a+'r glyphicon glyphicon-tower"></piece>'),a="knight "+c+" pos-",b[a+"l"]||d.push('<piece class="'+a+'l glyphicon glyphicon-knight"></piece>'),b[a+"r"]||d.push('<piece class="'+a+'r glyphicon glyphicon-knight"></piece>'),a="bishop "+c+" pos-",b[a+"l"]||d.push('<piece class="'+a+'l glyphicon glyphicon-bishop"></piece>'),b[a+"r"]||d.push('<piece class="'+a+'r glyphicon glyphicon-bishop"></piece>'),b["queen "+c+" pos-c"]||d.push('<piece class="queen '+c+' pos-c glyphicon glyphicon-queen"></piece>'),d};var Game=function(a,b,c,d){this.socket=new Signals(this,c),this.time=new Timer(this,b,d),this.color=a,this.opponent,this.map=[],this.id,this.overlay=function(a){var b=jQuery('<div id="overlay">'+a+"</div>");b.appendTo($("#board")),$("#board").bind("click",function(){$("#overlay").remove(),$(this).unbind("click")})},this.setId=function(a){this.id=a},this.getTile=function(a){return $("td")[a]},this.getPiece=function(a){return $("piece")[a]}};Game.prototype.isActive=function(){return"Not Started"!==$("state").text()},Game.prototype.convertMap=function(){return"black"===this.color?this.map.slice(0,64):this.map.slice(0,64).reverse()},Game.prototype.unlock=function(){this.setRules()},Game.prototype.lockout=function(){deactivate("highlight"),deactivate("highlight-enemy"),$("piece").unbind()},Game.prototype.createMap=function(){for(var a,b=$("piece"),c=b.length,d=0;d<c;d++)a=getClassNames(b[d]),a&&(a=mapKey(a)),this.map[a]=d,this.map[d]=a},Game.prototype.setupGame=function(a){$("#gameStatsBox").toggle(),$("#gameStats").bind("click",function(){$("#gameStatsBox").toggle()}),$("#quit").bind("click",this.quit.bind(this));var b=this.color;"black"===b?this.opponent="white":this.opponent="black",this.isActive()&&(this.socket.send("join",{id:this.id,time:this.time.time}),a===b&&(this.time.startTimer(),this.overlay("Your Turn"),this.setRules()))},Game.prototype.setRules=function(){pawnRules(this),rookRules(this),knightRules(this),bishopRules(this),kingRules(this),queenRules(this)},Game.prototype.quit=function(){this.socket.send("quit",{id:this.id}),window.location.href="/"},Game.prototype.winner=function(){this.time.clear(),this.lockout(),this.overlay("You Won"),this.socket.send("winner",this.id)},Game.prototype.loser=function(){$("#overlay").remove(),this.time.clear(),this.overlay("You Lost"),this.lockout()},Game.prototype.swapTurn=function(a){this.time.startTimer(),this.overlay(a),this.unlock(),$("turn").html(this.color)},Game.prototype.endTurn=function(){this.time.endTimer(),this.socket.send("save",{turn:this.opponent,board:this.map.slice(0,64),id:this.id}),this.lockout()},Game.prototype.updateMoved=function(a){var b=63-a.pos,c=63-a.mv,d=this.getTile(c);swapPiece(d,b,c)},Game.prototype.updateKilled=function(a){var b=63-a.pos,c=63-a.mv,d=this.getTile(c);killPiece(d,b,c)},Game.prototype.updatePiece=function(a){var b,c=a.piece,d=63-a.mv,e=this.map[d];this.map[c]=d,this.map[d]=a.piece,this.map[e]=void 0,b=this.getTile(d),$(b).empty(),$(b).append(jQuery(a.pieceCode))},Game.prototype.displayDead=function(a,b){var c=(this.getPiece(a),this.findDead()),d=c.length,e=this;if(this.map,d){for(var f='<div id="dead"><table><tr>',g=0;g<d;g++)f+="<td>"+c[g]+"</td>";var h=jQuery(f+"</tr></table></div>");h.appendTo($("#board")),$("#dead").find("piece").bind("click",function(){var a=e.getTile(b),c=mapKey(getClassNames(this)),d=e.map[b];e.map[d]=void 0,e.map[b]=c,e.map[c]=b,$(a).empty(),$(a).append(this),$("#dead").remove(),e.revive(c,$(a).html(),b),this.socket.send("revive",{id:this.id,piece:c,pieceCode:$(a).html(),mv:b,time:this.time.time,turn:this.opponent}),this.endTurn()})}else this.endTurn()},Game.prototype.findDead=function(){var a,b=this.map,c=this.color,d=[];return a="rook "+c+" pos-",b[a+"l"]||d.push('<piece class="'+a+'l glyphicon glyphicon-tower"></piece>'),b[a+"r"]||d.push('<piece class="'+a+'r glyphicon glyphicon-tower"></piece>'),a="knight "+c+" pos-",b[a+"l"]||d.push('<piece class="'+a+'l glyphicon glyphicon-knight"></piece>'),b[a+"r"]||d.push('<piece class="'+a+'r glyphicon glyphicon-knight"></piece>'),a="bishop "+c+" pos-",b[a+"l"]||d.push('<piece class="'+a+'l glyphicon glyphicon-bishop"></piece>'),b[a+"r"]||d.push('<piece class="'+a+'r glyphicon glyphicon-bishop"></piece>'),b["queen "+c+" pos-c"]||d.push('<piece class="queen '+c+' pos-c glyphicon glyphicon-queen"></piece>'),d};var Moves=function(a){};Moves.prototype.setGame=function(a){this.game=a},Moves.prototype.leftUp=function(a){a%this.boundaries.left_right==2||a<10||this.move(a-10,a)},Moves.prototype.leftDown=function(a){(a+1)%this.boundaries.left_right==2||a>55||this.move(a+6,a)},Moves.prototype.rightUp=function(a){(a+1)%this.boundaries.left_right==2||a<this.rowEnd||this.move(a-6,a)},Moves.prototype.rightDown=function(a){(a+1)%this.boundaries.left_right==2||a>53||this.move(a+10,a)},Moves.prototype.downRight=function(a){(a+1)%this.boundaries.left_right==2||a>46||this.move(a+17,a)},Moves.prototype.downLeft=function(a){a%this.boundaries.left_right==2||a>47||this.move(a+15,a)},Moves.prototype.upLeft=function(a){a%this.boundaries.left_right==2||a<17||this.move(a-17,a)},Moves.prototype.upRight=function(a){(a+1)%this.boundaries.left_right&&!(a<16)&&this.move(a-15,a)},Moves.prototype.diagnolFowardRight=function(a){mv>this.boundaries.forward&&(mv+1)%this.boundaries.left_right&&this.move(mv+this.moves.diagnolUR,a)},Moves.prototype.repeatedDiagnolFowardRight=function(a){for(var b=a;b>this.boundaries.forward&&(b+1)%this.boundaries.left_right&&(b+=this.diagnolUR,!this.move(b,a)););},Moves.prototype.repeatedDiagnolFowardLeft=function(a){for(var b=a;b>this.boundaries.forward&&b%this.boundaries.left_right&&(b+=this.moves.diagnolUL,!this.move(b,a)););},Moves.prototype.diagnolFowardLeft=function(a){mv>this.boundaries.forward&&mv%this.boundaries.left_right&&this.move(mv+this.moves.diagnolUL,a)},Moves.prototype.repeatedDiagnolBackLeft=function(a){for(var b=a;b<this.boundaries.backward&&b%this.boundaries.left_right&&(b+=this.moves.diagnolDL,!this.move(b,a)););},Moves.prototype.diagnolBackLeft=function(a){mv<this.boundaries.backward&&mv%this.boundaries.left_right&&this.move(mv+this.moves.diagnolDL,a)},Moves.prototype.repeatedDiagnolBackRight=function(a){for(var b=a;b<this.boundaries.backward&&(b+1)%this.boundaries.left_right&&(b+=this.moves.diagnolDR,!this.move(b,a)););},Moves.prototype.diagnolBackRight=function(a){mv<this.boundaries.backward&&(mv+1)%this.boundaries.left_right&&this.move(mv+this.moves.diagnolUR,a)},Moves.prototype.repeatForward=function(a){for(var b=a;b>this.boundaries.forward&&(b+=this.moves.forward,!this.move(b,a)););},Moves.prototype.forward=function(a){a>this.boundaries.forward&&this.move(a+this.moves.forward,a)},Moves.prototype.repeatBackward=function(a){for(var b=a;b<this.boundaries.backward&&(b+=this.moves.backward,!this.move(b,a)););},Moves.prototype.backward=function(a){a<this.boundaries.backward&&this.move(a+this.moves.backward,a)},Moves.prototype.repeatedLeft=function(a){for(var b=a;b%this.boundaries.left_right&&(b+=this.moves.left,!this.move(b,a)););},Moves.prototype.left=function(a){a%this.boundaries.left_right&&this.move(a+this.moves.left,a)},Moves.prototype.repeatedRight=function(a){for(var b=a;(b+1)%this.boundaries.left_right&&(b+=this.moves.right,!this.move(b,a)););},Moves.prototype.right=function(a){(a+1)%this.boundaries.left_right&&this.move(a+this.moves.right,a)},Moves.prototype.move=function(a,b){var c=this.game,d=this.getPiece(a);return d&&d.split(" ")[1]===c.opponent?(d=c.getTile(a),$(d).hasClass("highlight-enemy")?$(d).unbind("click"):$(d).bind("click",function(){killPiece(c.getTile(b),d,b,a),c.socket.send("killPiece",{id:c.id,turn:c.turn,time:c.moveTime,pos:b,mv:a})}),$(d).toggleClass("highlight-enemy"),1):($(d).hasClass("highlight")?$(d).unbind("click"):$(d).bind("click",function(){swapPiece(this.getTile(b),d,b,a),c.swap(b,a),c.socket.send("swapPiece",{id:c.id,turn:c.turn,time:c.moveTime,pos:b,mv:a}),c.endTurn()}),$(d).toggleClass("highlight"),0)},Moves.prototype.pawnMove=function(a,b){for(var c,d=this.game,e=d.getTile(b),f=0;f<2&&(c=d.map[a],c||(c=d.getTile(a),$(c).hasClass("highlight")?$(c).unbind("click"):$(c).bind("click",swapPiece.bind(e,c,b,a,d)),$(c).toggleClass("highlight")),!(a<=39));f++)a+=this.moves.forward},Moves.prototype.pawnAttack=function(a,b){var c=this.game,d=c.map[a];d&&d.split(" ")[1]===c.opponent&&(d=c.getPiece(a),$(d).hasClass("highlight-enemy")?$(d).unbind("click"):$(d).bind("click",function(){killPiece(d,b,a,c),c.socket.send("killPiece",{id:c.id,turn:c.turn,time:c.moveTime,pos:b,mv:a}),a<8?c.displayDead(this,b,a):c.endTurn()}),$(d).toggleClass("highlight-enemy"))};var Signals=function(a,b){};Signals.prototype.setSignals=function(){this.socket&&(this.socket.on("start",this.start()),this.socket.on("quit",this.quit()),this.socket.on("loser",this.loser()),this.socket.on("swapTurn",this.swapTurn()),this.socket.on("time",this.recvTime(data)),this.socket.on("revive",this.revive(data)),this.socket.on("killed",this.killed(data)),this.socket.on("swaped",this.swaped(data)),this.socket.on("lockout",this.lockout(color)),this.socket.on("timedout",this.timedout(color)))},Signals.prototype.setSocket=function(a){this.socket=a},Signals.prototype.setGame=function(a){this.game=a},Signals.prototype.recvTime=function(a){this.game.time.timeObj=a},Signals.prototype.swapTurn=function(a){this.game.swapTurn("Your Turn")},Signals.prototype.killed=function(a){this.game.updateKilled(a)},Signals.prototype.swaped=function(a){this.game.updateKilled(a)},Signals.prototype.loser=function(){this.game.loser()},Signals.prototype.revive=function(a){this.game.updatePiece(a),this.game.swapTurn("Your Turn")},Signals.prototype.start=function(){var a=$("state");$(a).removeClass("notactive"),$(a).addClass("active"),$(a).html("Active"),"white"===this.game.color&&(this.game.startTimer(),this.game.overlay("Your Turn"),this.game.unlock())},Signals.prototype.quit=function(){this.game.overlay("You Win Opponent Forfeits"),this.game.endTimer(),this.game.lockout()},Signals.prototype.timedOut=function(a){this.game.color===a?($("#overlay").remove(),this.game.swapTurn("Your Opponent Timed Out")):($("#overlay").remove(),this.game.overlay("Turn Timed Out"),$("turn").html(this.game.opponent),this.game.endTimer(),this.game.lockout())},Signals.prototype.lockout=function(a){game.lockout(),game.overlay("Refresh Page to Continue")},Signals.prototype.send=function(a,b){this.socket.emit(a,b)};var Timer=function(a,b,c){};Timer.prototype.setGame=function(a){this.game=a},Timer.prototype.setMoveTime=function(a){this.time=a},Timer.prototype.setLastTime=function(a){this.timeObj=a},Timer.prototype.startTimer=function(){var a,b=Date.parse(new Date);a=this.timeObj?(b-this.timeObj)%this.time:b+this.time,this.timefn=setInterval(this.setTimer.bind(this,a),1e3)},Timer.prototype.endTimer=function(){clearInterval(this.timefn),$("#clock").html("N/A")},Timer.prototype.setTimer=function(a){var b=(a-Date.parse(new Date))/1e3,c=this.parseTime(b);$("#clock").html("minutes: "+c.min+" seconds: "+c.sec),b<=0&&(clearInterval(this.timefn),window.location.replace(""))};var Moves=function(a){};Moves.prototype.setGame=function(a){this.game=a},Moves.prototype.leftUp=function(a){a%this.boundaries.left_right==2||a<10||this.move(a-10,a)},Moves.prototype.leftDown=function(a){(a+1)%this.boundaries.left_right==2||a>55||this.move(a+6,a)},Moves.prototype.rightUp=function(a){(a+1)%this.boundaries.left_right==2||a<this.rowEnd||this.move(a-6,a)},Moves.prototype.rightDown=function(a){(a+1)%this.boundaries.left_right==2||a>53||this.move(a+10,a)},Moves.prototype.downRight=function(a){(a+1)%this.boundaries.left_right==2||a>46||this.move(a+17,a)},Moves.prototype.downLeft=function(a){a%this.boundaries.left_right==2||a>47||this.move(a+15,a)},Moves.prototype.upLeft=function(a){a%this.boundaries.left_right==2||a<17||this.move(a-17,a)},Moves.prototype.upRight=function(a){(a+1)%this.boundaries.left_right&&!(a<16)&&this.move(a-15,a)},Moves.prototype.diagnolFowardRight=function(a){mv>this.boundaries.forward&&(mv+1)%this.boundaries.left_right&&this.move(mv+this.moves.diagnolUR,a)},Moves.prototype.repeatedDiagnolFowardRight=function(a){for(var b=a;b>this.boundaries.forward&&(b+1)%this.boundaries.left_right&&(b+=this.diagnolUR,!this.move(b,a)););},Moves.prototype.repeatedDiagnolFowardLeft=function(a){for(var b=a;b>this.boundaries.forward&&b%this.boundaries.left_right&&(b+=this.moves.diagnolUL,!this.move(b,a)););},Moves.prototype.diagnolFowardLeft=function(a){mv>this.boundaries.forward&&mv%this.boundaries.left_right&&this.move(mv+this.moves.diagnolUL,a)},Moves.prototype.repeatedDiagnolBackLeft=function(a){for(var b=a;b<this.boundaries.backward&&b%this.boundaries.left_right&&(b+=this.moves.diagnolDL,!this.move(b,a)););},Moves.prototype.diagnolBackLeft=function(a){mv<this.boundaries.backward&&mv%this.boundaries.left_right&&this.move(mv+this.moves.diagnolDL,a)},Moves.prototype.repeatedDiagnolBackRight=function(a){for(var b=a;b<this.boundaries.backward&&(b+1)%this.boundaries.left_right&&(b+=this.moves.diagnolDR,!this.move(b,a)););},Moves.prototype.diagnolBackRight=function(a){mv<this.boundaries.backward&&(mv+1)%this.boundaries.left_right&&this.move(mv+this.moves.diagnolUR,a)},Moves.prototype.repeatForward=function(a){for(var b=a;b>this.boundaries.forward&&(b+=this.moves.forward,!this.move(b,a)););},Moves.prototype.forward=function(a){a>this.boundaries.forward&&this.move(a+this.moves.forward,a)},Moves.prototype.repeatBackward=function(a){for(var b=a;b<this.boundaries.backward&&(b+=this.moves.backward,!this.move(b,a)););},Moves.prototype.backward=function(a){a<this.boundaries.backward&&this.move(a+this.moves.backward,a)},Moves.prototype.repeatedLeft=function(a){for(var b=a;b%this.boundaries.left_right&&(b+=this.moves.left,!this.move(b,a)););},Moves.prototype.left=function(a){a%this.boundaries.left_right&&this.move(a+this.moves.left,a)},Moves.prototype.repeatedRight=function(a){for(var b=a;(b+1)%this.boundaries.left_right&&(b+=this.moves.right,!this.move(b,a)););},Moves.prototype.right=function(a){(a+1)%this.boundaries.left_right&&this.move(a+this.moves.right,a)},Moves.prototype.move=function(a,b){var c=this.game,d=this.getPiece(a);return d&&d.split(" ")[1]===c.opponent?(d=c.getTile(a),$(d).hasClass("highlight-enemy")?$(d).unbind("click"):$(d).bind("click",function(){killPiece(c.getTile(b),d,b,a),c.socket.send("killPiece",{id:c.id,turn:c.turn,time:c.moveTime,pos:b,mv:a})}),$(d).toggleClass("highlight-enemy"),1):($(d).hasClass("highlight")?$(d).unbind("click"):$(d).bind("click",function(){swapPiece(this.getTile(b),d,b,a),c.swap(b,a),c.socket.send("swapPiece",{id:c.id,turn:c.turn,time:c.moveTime,pos:b,mv:a}),c.endTurn()}),$(d).toggleClass("highlight"),0)},Moves.prototype.pawnMove=function(a,b){for(var c,d=this.game,e=d.getTile(b),f=0;f<2&&(c=d.map[a],c||(c=d.getTile(a),$(c).hasClass("highlight")?$(c).unbind("click"):$(c).bind("click",swapPiece.bind(e,c,b,a,d)),$(c).toggleClass("highlight")),!(a<=39));f++)a+=this.moves.forward},Moves.prototype.pawnAttack=function(a,b){var c=this.game,d=c.map[a];d&&d.split(" ")[1]===c.opponent&&(d=c.getPiece(a),$(d).hasClass("highlight-enemy")?$(d).unbind("click"):$(d).bind("click",function(){killPiece(d,b,a,c),c.socket.send("killPiece",{id:c.id,turn:c.turn,time:c.moveTime,pos:b,mv:a}),a<8?c.displayDead(this,b,a):c.endTurn()}),$(d).toggleClass("highlight-enemy"))};var Signals=function(a,b){};Signals.prototype.setSignals=function(){this.socket&&(this.socket.on("start",this.start()),this.socket.on("quit",this.quit()),this.socket.on("loser",this.loser()),this.socket.on("swapTurn",this.swapTurn()),this.socket.on("time",this.recvTime(data)),this.socket.on("revive",this.revive(data)),this.socket.on("killed",this.killed(data)),this.socket.on("swaped",this.swaped(data)),this.socket.on("lockout",this.lockout(color)),this.socket.on("timedout",this.timedout(color)))},Signals.prototype.setSocket=function(a){this.socket=a},Signals.prototype.setGame=function(a){this.game=a},Signals.prototype.recvTime=function(a){this.game.time.timeObj=a},Signals.prototype.swapTurn=function(a){this.game.swapTurn("Your Turn")},Signals.prototype.killed=function(a){this.game.updateKilled(a)},Signals.prototype.swaped=function(a){this.game.updateKilled(a)},Signals.prototype.loser=function(){this.game.loser()},Signals.prototype.revive=function(a){this.game.updatePiece(a),this.game.swapTurn("Your Turn")},Signals.prototype.start=function(){var a=$("state");$(a).removeClass("notactive"),$(a).addClass("active"),$(a).html("Active"),"white"===this.game.color&&(this.game.startTimer(),this.game.overlay("Your Turn"),this.game.unlock())},Signals.prototype.quit=function(){this.game.overlay("You Win Opponent Forfeits"),this.game.endTimer(),this.game.lockout()},Signals.prototype.timedOut=function(a){this.game.color===a?($("#overlay").remove(),this.game.swapTurn("Your Opponent Timed Out")):($("#overlay").remove(),this.game.overlay("Turn Timed Out"),$("turn").html(this.game.opponent),this.game.endTimer(),this.game.lockout())},Signals.prototype.lockout=function(a){game.lockout(),game.overlay("Refresh Page to Continue")},Signals.prototype.send=function(a,b){this.socket.emit(a,b)};var Timer=function(a,b,c){};Timer.prototype.setGame=function(a){this.game=a},Timer.prototype.setMoveTime=function(a){this.time=a},Timer.prototype.setLastTime=function(a){this.timeObj=a},Timer.prototype.startTimer=function(){var a,b=Date.parse(new Date);a=this.timeObj?(b-this.timeObj)%this.time:b+this.time,this.timefn=setInterval(this.setTimer.bind(this,a),1e3)},Timer.prototype.endTimer=function(){clearInterval(this.timefn),$("#clock").html("N/A")},Timer.prototype.setTimer=function(a){var b=(a-Date.parse(new Date))/1e3,c=this.parseTime(b);$("#clock").html("minutes: "+c.min+" seconds: "+c.sec),b<=0&&(clearInterval(this.timefn),window.location.replace(""))};
//# sourceMappingURL=../../../sourceMap.map